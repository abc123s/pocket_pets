

## Random Battle Generation ##
As we mentioned in our design doc, our random battle generation depends on the geographical location of the user, both gps coordinates and altitude. We use the iPhone's built in CLLocationManager to determine the user's gps coordinates and altitude, CLGeocoder to determine whether the user is near water, as well as Google's Elevation API to determine whether or not the user is high above the ground (and we use the built in XML parser to do so). While all these tasks - waiting for gps coordinates, location information, and xml parsing - all theoretically happen asynchronously, we use dispatch groups to force them to happen synchronously and in series. There are two reasons for this. (1) We cannot start a battle until we have this data, as we need this data to pick a random pet to fight against. (2) We make multiple reverse geocoding requests, and these requests must be made in series; otherwise they are rejected. Furthermore, we first make the request from google elevation before making the request for reverse geocoding data because Apple's developer's guidelines specify that we should limit such requests as much as possible, and thus we do not make the water-closeness checks if we already know we're going to face an air pet. Ultimately, this means that there is a noticable pause between requesting a battle and having the battle screen appear, but this is a necessary inconvenience.    
